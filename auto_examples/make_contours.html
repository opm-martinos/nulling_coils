
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Design biplanar coils &#8212; opmcoils  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=fd10adb8"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/make_contours';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">opmcoils</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="index.html">
    Example gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../assembly.html">
    Frame assembly
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/opm-martinos/cmeg_coil_design" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="index.html">
    Example gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../assembly.html">
    Frame assembly
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/opm-martinos/cmeg_coil_design" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Design biplanar coils</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-make-contours-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="design-biplanar-coils">
<span id="sphx-glr-auto-examples-make-contours-py"></span><h1>Design biplanar coils<a class="headerlink" href="#design-biplanar-coils" title="Link to this heading">#</a></h1>
<p>Example demonstrating how to create biplanar coils for production.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Mainak Jas &lt;mjas@mgh.harvard.edu&gt;</span>
<span class="c1">#          Padma Sundaram &lt;padma@nmr.mgh.harvard.edu&gt;</span>

<span class="c1"># First, we will import the necessary libraries</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">bfieldtools.utils</span> <span class="kn">import</span> <span class="n">load_example_mesh</span>

<span class="kn">import</span> <span class="nn">opm_coils</span>
<span class="kn">from</span> <span class="nn">opm_coils</span> <span class="kn">import</span> <span class="n">BiplanarCoil</span><span class="p">,</span> <span class="n">get_sphere_points</span><span class="p">,</span> <span class="n">get_target_field</span>
<span class="kn">from</span> <span class="nn">opm_coils.shielding</span> <span class="kn">import</span> <span class="n">shielded_room</span>

<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">N_suh</span></a> <span class="o">=</span> <span class="mi">50</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">N_contours</span></a> <span class="o">=</span> <span class="mi">30</span>

<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">center</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_type</span></a> <span class="o">=</span> <span class="s1">&#39;dc_y&#39;</span>  <span class="c1"># &#39;gradient_x&#39; | &#39;gradient_y&#39; | &#39;dc_x&#39; | &#39;dc_y&#39; | &#39;dc_grad_x&#39; etc.</span>
</pre></div>
</div>
<p>Next we define the output directory containing the kicad files for our
PCB design.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pcb_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">opm_coils</span><span class="o">.</span><span class="n">__path__</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">output_dir</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dc_x&#39;</span><span class="p">:</span> <span class="s1">&#39;Bx_coil&#39;</span><span class="p">,</span>
              <span class="s1">&#39;dc_y&#39;</span><span class="p">:</span> <span class="s1">&#39;By_coil&#39;</span><span class="p">,</span>
              <span class="s1">&#39;dc_z&#39;</span><span class="p">:</span> <span class="s1">&#39;Bz_coil&#39;</span><span class="p">,</span>
              <span class="s1">&#39;gradient_x&#39;</span><span class="p">:</span> <span class="s1">&#39;Gx_coil&#39;</span><span class="p">,</span>
              <span class="s1">&#39;gradient_y&#39;</span><span class="p">:</span> <span class="s1">&#39;Gy_coil&#39;</span><span class="p">,</span>
              <span class="s1">&#39;gradient_z&#39;</span><span class="p">:</span> <span class="s1">&#39;Gz_coil&#39;</span><span class="p">}</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">header_type</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dc_x&#39;</span><span class="p">:</span> <span class="s1">&#39;vert&#39;</span><span class="p">,</span>
               <span class="s1">&#39;dc_y&#39;</span><span class="p">:</span> <span class="s1">&#39;horz&#39;</span><span class="p">,</span>
               <span class="s1">&#39;dc_z&#39;</span><span class="p">:</span> <span class="s1">&#39;vert&#39;</span><span class="p">,</span>
               <span class="s1">&#39;gradient_x&#39;</span><span class="p">:</span> <span class="s1">&#39;vert&#39;</span><span class="p">,</span>
               <span class="s1">&#39;gradient_y&#39;</span><span class="p">:</span> <span class="s1">&#39;horz&#39;</span><span class="p">,</span>
               <span class="s1">&#39;gradient_z&#39;</span><span class="p">:</span> <span class="s1">&#39;vert&#39;</span><span class="p">}</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bounds_wholeloop</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dc_x&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s1">&#39;dc_y&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;dc_z&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s1">&#39;gradient_x&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                    <span class="s1">&#39;gradient_y&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;gradient_z&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
</pre></div>
</div>
<p>Next we will define the parameters of our coils</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">standoffs</span></a> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dc_y&quot;</span><span class="p">:</span> <span class="mf">0.1400</span><span class="p">,</span> <span class="s2">&quot;gradient_y&quot;</span><span class="p">:</span> <span class="mf">0.1408</span><span class="p">,</span>
             <span class="s2">&quot;dc_x&quot;</span><span class="p">:</span> <span class="mf">0.1416</span><span class="p">,</span> <span class="s2">&quot;gradient_x&quot;</span><span class="p">:</span> <span class="mf">0.1424</span><span class="p">,</span>
             <span class="s2">&quot;dc_z&quot;</span><span class="p">:</span> <span class="mf">0.1432</span><span class="p">,</span> <span class="s2">&quot;gradient_z&quot;</span><span class="p">:</span> <span class="mf">0.1440</span><span class="p">}</span>

<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scaling</span></a> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;dc_y&quot;</span><span class="p">:</span> <span class="mf">0.1400</span><span class="p">,</span> <span class="s2">&quot;gradient_y&quot;</span><span class="p">:</span> <span class="mf">0.1420</span><span class="p">,</span>
           <span class="s2">&quot;dc_x&quot;</span><span class="p">:</span> <span class="mf">0.1420</span><span class="p">,</span> <span class="s2">&quot;gradient_x&quot;</span><span class="p">:</span> <span class="mf">0.1436</span><span class="p">,</span>
           <span class="s2">&quot;dc_z&quot;</span><span class="p">:</span> <span class="mf">0.1441</span><span class="p">,</span> <span class="s2">&quot;gradient_z&quot;</span><span class="p">:</span> <span class="mf">0.14565</span><span class="p">}</span>

<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trace_width</span></a> <span class="o">=</span> <span class="mf">5.</span> <span class="c1"># mm</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cu_oz</span></a> <span class="o">=</span> <span class="mf">2.</span> <span class="c1"># oz per ft^2</span>
</pre></div>
</div>
<p>A 10 m x 10 m biplanar coil mesh is loaded from bfieldtools.
We will scale the mesh so as to achieve the dimensions of
1.4 m x 1.4 m that we will use in our work.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scaling_factor</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scaling</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_type</span></a><span class="p">]</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">standoff</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scaling_factor</span></a> <span class="o">*</span> <span class="mi">10</span>

<span class="n">planemesh</span> <span class="o">=</span> <span class="n">load_example_mesh</span><span class="p">(</span><span class="s2">&quot;10x10_plane_hires&quot;</span><span class="p">)</span>
<span class="n">planemesh</span><span class="o">.</span><span class="n">apply_scale</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">scaling_factor</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;trimesh.Trimesh(vertices.shape=(1592, 3), faces.shape=(3038, 3), name=`10x10_plane_hires.obj`)&gt;
</pre></div>
</div>
<p>The BiplanarCoil class is instantiated</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">coil</span> <span class="o">=</span> <span class="n">BiplanarCoil</span><span class="p">(</span><span class="n">planemesh</span><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">center</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">N_suh</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">N_suh</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">standoff</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">standoff</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Calculating surface harmonics expansion...
Computing the laplacian matrix...
Computing the mass matrix...
Calculating surface harmonics expansion...
Computing the laplacian matrix...
Computing the mass matrix...
</pre></div>
</div>
<p>Then the target points and the fields are used to fit the coil design</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_points</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">points_z</span></a> <span class="o">=</span> <span class="n">get_sphere_points</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">center</span></a><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">sidelength</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_field</span></a> <span class="o">=</span> <span class="n">get_target_field</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_type</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_points</span></a><span class="p">)</span>

<span class="n">coil</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_points</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_field</span></a><span class="p">)</span>

<span class="n">coil</span><span class="o">.</span><span class="n">discretize</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">N_contours</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">N_contours</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trace_width</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">trace_width</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cu_oz</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cu_oz</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing magnetic field coupling matrix, 3184 vertices by 160 target points... took 0.38 seconds.
Computing the resistance matrix...
Passing problem to solver...
===============================================================================
                                     CVXPY
                                     v1.4.1
===============================================================================
(CVXPY) Jan 08 12:13:21 PM: Your problem has 100 variables, 2 constraints, and 0 parameters.
(CVXPY) Jan 08 12:13:21 PM: It is compliant with the following grammars: DCP, DQCP
(CVXPY) Jan 08 12:13:21 PM: (If you need to solve this problem multiple times, but with different data, consider using parameters.)
(CVXPY) Jan 08 12:13:21 PM: CVXPY will first compile your problem; then, it will invoke a numerical solver to obtain a solution.
(CVXPY) Jan 08 12:13:21 PM: Your problem is compiled with the CPP canonicalization backend.
-------------------------------------------------------------------------------
                                  Compilation
-------------------------------------------------------------------------------
(CVXPY) Jan 08 12:13:21 PM: Compiling problem (target solver=MOSEK).
(CVXPY) Jan 08 12:13:21 PM: Reduction chain: Dcp2Cone -&gt; CvxAttr2Constr -&gt; ConeMatrixStuffing -&gt; MOSEK
(CVXPY) Jan 08 12:13:21 PM: Applying reduction Dcp2Cone
(CVXPY) Jan 08 12:13:21 PM: Applying reduction CvxAttr2Constr
(CVXPY) Jan 08 12:13:21 PM: Applying reduction ConeMatrixStuffing
(CVXPY) Jan 08 12:13:21 PM: Applying reduction MOSEK
(CVXPY) Jan 08 12:13:21 PM: Finished problem compilation (took 4.362e-02 seconds).
-------------------------------------------------------------------------------
                                Numerical solver
-------------------------------------------------------------------------------
(CVXPY) Jan 08 12:13:21 PM: Invoking solver MOSEK  to obtain a solution.


/Users/mainak/anaconda3/envs/bfieldtools/lib/python3.9/site-packages/cvxpy/reductions/solvers/conic_solvers/mosek_conif.py:663: UserWarning:
Using MOSEK constants to specify parameters is deprecated.
Use generic string names instead.
For example, replace mosek.iparam.num_threads with &#39;MSK_IPAR_NUM_THREADS&#39;

  warnings.warn(__MSK_ENUM_PARAM_DEPRECATION__, UserWarning)
(CVXPY) Jan 08 12:13:21 PM: Problem
(CVXPY) Jan 08 12:13:21 PM:   Name                   :
(CVXPY) Jan 08 12:13:21 PM:   Objective sense        : maximize
(CVXPY) Jan 08 12:13:21 PM:   Type                   : CONIC (conic optimization problem)
(CVXPY) Jan 08 12:13:21 PM:   Constraints            : 101
(CVXPY) Jan 08 12:13:21 PM:   Affine conic cons.     : 0
(CVXPY) Jan 08 12:13:21 PM:   Disjunctive cons.      : 0
(CVXPY) Jan 08 12:13:21 PM:   Cones                  : 1
(CVXPY) Jan 08 12:13:21 PM:   Scalar variables       : 1062
(CVXPY) Jan 08 12:13:21 PM:   Matrix variables       : 0
(CVXPY) Jan 08 12:13:21 PM:   Integer variables      : 0
(CVXPY) Jan 08 12:13:21 PM:
(CVXPY) Jan 08 12:13:21 PM: Optimizer started.
(CVXPY) Jan 08 12:13:21 PM: Presolve started.
(CVXPY) Jan 08 12:13:21 PM: Linear dependency checker started.
(CVXPY) Jan 08 12:13:21 PM: Linear dependency checker terminated.
(CVXPY) Jan 08 12:13:21 PM: Eliminator started.
(CVXPY) Jan 08 12:13:21 PM: Freed constraints in eliminator : 0
(CVXPY) Jan 08 12:13:21 PM: Eliminator terminated.
(CVXPY) Jan 08 12:13:21 PM: Eliminator - tries                  : 1                 time                   : 0.00
(CVXPY) Jan 08 12:13:21 PM: Lin. dep.  - tries                  : 1                 time                   : 0.00
(CVXPY) Jan 08 12:13:21 PM: Lin. dep.  - primal attempts        : 1                 successes              : 1
(CVXPY) Jan 08 12:13:21 PM: Lin. dep.  - dual attempts          : 0                 successes              : 0
(CVXPY) Jan 08 12:13:21 PM: Lin. dep.  - primal deps.           : 0                 dual deps.             : 0
(CVXPY) Jan 08 12:13:21 PM: Presolve terminated. Time: 0.02
(CVXPY) Jan 08 12:13:21 PM: Optimizer  - threads                : 8
(CVXPY) Jan 08 12:13:21 PM: Optimizer  - solved problem         : the primal
(CVXPY) Jan 08 12:13:21 PM: Optimizer  - Constraints            : 101
(CVXPY) Jan 08 12:13:21 PM: Optimizer  - Cones                  : 1
(CVXPY) Jan 08 12:13:21 PM: Optimizer  - Scalar variables       : 1062              conic                  : 102
(CVXPY) Jan 08 12:13:21 PM: Optimizer  - Semi-definite variables: 0                 scalarized             : 0
(CVXPY) Jan 08 12:13:21 PM: Factor     - setup time             : 0.01
(CVXPY) Jan 08 12:13:21 PM: Factor     - dense det. time        : 0.00              GP order time          : 0.00
(CVXPY) Jan 08 12:13:21 PM: Factor     - nonzeros before factor : 5151              after factor           : 5151
(CVXPY) Jan 08 12:13:21 PM: Factor     - dense dim.             : 0                 flops                  : 5.21e+06
(CVXPY) Jan 08 12:13:21 PM: ITE PFEAS    DFEAS    GFEAS    PRSTATUS   POBJ              DOBJ              MU       TIME
(CVXPY) Jan 08 12:13:21 PM: 0   1.0e+00  3.3e+01  2.0e+00  0.00e+00   -1.000000000e+00  -0.000000000e+00  1.0e+00  0.04
(CVXPY) Jan 08 12:13:21 PM: 1   6.2e-01  2.0e+01  1.2e+00  -3.67e-01  8.074102027e+00   8.717140478e+00   6.2e-01  0.05
(CVXPY) Jan 08 12:13:21 PM: 2   3.8e-01  1.3e+01  6.2e-01  -3.32e-01  3.854016341e+01   3.898638953e+01   3.8e-01  0.05
(CVXPY) Jan 08 12:13:21 PM: 3   3.6e-01  1.2e+01  5.7e-01  8.21e-01   5.206605879e+01   5.248526896e+01   3.6e-01  0.05
(CVXPY) Jan 08 12:13:22 PM: 4   1.7e-01  5.6e+00  1.6e-01  1.79e+00   1.066982891e+02   1.068317814e+02   1.7e-01  0.05
(CVXPY) Jan 08 12:13:22 PM: 5   3.1e-02  1.0e+00  3.1e-02  1.05e+00   1.501850630e+02   1.500705013e+02   3.1e-02  0.05
(CVXPY) Jan 08 12:13:22 PM: 6   1.3e-02  4.1e-01  1.2e-02  -2.45e-01  1.944314242e+02   1.942993967e+02   1.3e-02  0.06
(CVXPY) Jan 08 12:13:22 PM: 7   5.0e-03  1.6e-01  3.0e-03  4.10e-01   2.496052248e+02   2.495539387e+02   5.0e-03  0.06
(CVXPY) Jan 08 12:13:22 PM: 8   7.4e-04  2.4e-02  2.1e-04  8.56e-01   2.962092237e+02   2.961967180e+02   7.4e-04  0.06
(CVXPY) Jan 08 12:13:22 PM: 9   1.4e-04  4.6e-03  1.5e-05  9.24e-01   3.062824194e+02   3.062810007e+02   1.4e-04  0.06
(CVXPY) Jan 08 12:13:22 PM: 10  2.3e-05  7.7e-04  1.1e-06  9.68e-01   3.083219504e+02   3.083216445e+02   2.3e-05  0.06
(CVXPY) Jan 08 12:13:22 PM: 11  1.7e-08  5.4e-07  2.0e-11  9.99e-01   3.087298312e+02   3.087298310e+02   1.7e-08  0.07
(CVXPY) Jan 08 12:13:22 PM: 12  6.4e-10  3.7e-09  3.9e-13  1.00e+00   3.087301435e+02   3.087301433e+02   4.3e-12  0.07
(CVXPY) Jan 08 12:13:22 PM: Optimizer terminated. Time: 0.08
(CVXPY) Jan 08 12:13:22 PM:
(CVXPY) Jan 08 12:13:22 PM:
(CVXPY) Jan 08 12:13:22 PM: Interior-point solution summary
(CVXPY) Jan 08 12:13:22 PM:   Problem status  : PRIMAL_AND_DUAL_FEASIBLE
(CVXPY) Jan 08 12:13:22 PM:   Solution status : OPTIMAL
(CVXPY) Jan 08 12:13:22 PM:   Primal.  obj: 3.0873014354e+02    nrm: 1e+03    Viol.  con: 4e-09    var: 0e+00    cones: 0e+00
(CVXPY) Jan 08 12:13:22 PM:   Dual.    obj: 3.0873014335e+02    nrm: 6e+02    Viol.  con: 0e+00    var: 2e-08    cones: 0e+00
-------------------------------------------------------------------------------
                                    Summary
-------------------------------------------------------------------------------
(CVXPY) Jan 08 12:13:22 PM: Problem status: optimal
(CVXPY) Jan 08 12:13:22 PM: Optimal value: 3.087e+02
(CVXPY) Jan 08 12:13:22 PM: Compilation took 4.362e-02 seconds
(CVXPY) Jan 08 12:13:22 PM: Solver (including time spent in interface) took 1.298e-01 seconds
Processing contour, value: -9955702.158503016
Processing contour, value: -9268942.937399967
Processing contour, value: -8582183.716296915
Processing contour, value: -7895424.495193865
Processing contour, value: -7208665.274090815
Processing contour, value: -6521906.052987765
Processing contour, value: -5835146.831884715
Processing contour, value: -5148387.610781664
Processing contour, value: -4461628.389678614
Processing contour, value: -3774869.1685755635
Processing contour, value: -3088109.9474725137
Processing contour, value: -2401350.726369463
Processing contour, value: -1714591.505266413
Processing contour, value: -1027832.2841633633
Processing contour, value: -341073.0630603116
Processing contour, value: 345686.1580427382
Processing contour, value: 1032445.379145788
Processing contour, value: 1719204.6002488378
Processing contour, value: 2405963.8213518895
Processing contour, value: 3092723.0424549393
Processing contour, value: 3779482.263557989
Processing contour, value: 4466241.484661039
Processing contour, value: 5153000.705764091
Processing contour, value: 5839759.92686714
Processing contour, value: 6526519.14797019
Processing contour, value: 7213278.36907324
Processing contour, value: 7900037.59017629
Processing contour, value: 8586796.81127934
Processing contour, value: 9273556.032382393
Processing contour, value: 9960315.253485443
</pre></div>
</div>
<p>To evaluate the effect of the shielded room, we can add it to the coil
specification and it will be taken into account for estimating the
magnetic field at any point</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">room_dims</span></a> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">3.</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_pos</span></a> <span class="o">=</span> <span class="p">(</span><span class="mf">1.89</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">)</span>
<span class="n">shield_mesh</span> <span class="o">=</span> <span class="n">shielded_room</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">room_dims</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">room_dims</span></a><span class="p">,</span>
                            <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_pos</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">coil_pos</span></a><span class="p">)</span>
<span class="n">coil</span><span class="o">.</span><span class="n">add_shield</span><span class="p">(</span><span class="n">shield_mesh</span><span class="p">)</span>
</pre></div>
</div>
<p>The field at some target points can be computed by doing</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">B_target</span></a> <span class="o">=</span> <span class="n">coil</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_points</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing effect of shielded room
Computing magnetic field coupling matrix, 4056 vertices by 160 target points... took 0.44 seconds.
Computing scalar potential coupling matrix, 4056 vertices by 4056 target points... took 16.43 seconds.
Computing scalar potential coupling matrix, 3184 vertices by 4056 target points... took 12.41 seconds.
Done
</pre></div>
</div>
<p>The field can be computed and plotted by doing</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">coil</span><span class="o">.</span><span class="n">plot_field</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_points</span></a><span class="p">)</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_make_contours_001.png" srcset="../_images/sphx_glr_make_contours_001.png" alt="make contours" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing effect of shielded room
Computing magnetic field coupling matrix, 4056 vertices by 160 target points... took 0.52 seconds.
Computing scalar potential coupling matrix, 4056 vertices by 4056 target points... took 16.44 seconds.
Done
</pre></div>
</div>
<p>We can evaluate the coil for metrics such as efficiency
and also compute its dimensions by doing</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">metrics</span></a> <span class="o">=</span> <span class="n">coil</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_type</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_points</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_field</span></a><span class="p">,</span>
                        <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">points_z</span></a><span class="p">,</span> <span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">metrics</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The coil has dimensions </span><span class="si">{</span><span class="n">coil</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1"> m&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Computing magnetic field coupling matrix, 3184 vertices by 8 target points... took 0.03 seconds.
Computing effect of shielded room
Computing magnetic field coupling matrix, 4056 vertices by 160 target points... took 0.37 seconds.
Computing scalar potential coupling matrix, 4056 vertices by 4056 target points... took 16.14 seconds.
Done
Computing effect of shielded room
Computing magnetic field coupling matrix, 4056 vertices by 8 target points... took 0.03 seconds.
Computing scalar potential coupling matrix, 4056 vertices by 4056 target points... took 16.80 seconds.
Done
Computing effect of shielded room
Computing magnetic field coupling matrix, 4056 vertices by 160 target points... took 0.36 seconds.
Computing scalar potential coupling matrix, 4056 vertices by 4056 target points... took 15.14 seconds.
Done
Computing effect of shielded room
Computing magnetic field coupling matrix, 4056 vertices by 160 target points... took 0.37 seconds.
Computing scalar potential coupling matrix, 4056 vertices by 4056 target points... took 15.65 seconds.
Done
Computing the inductance matrix...
Computing self-inductance matrix using rough quadrature (degree=2).              For higher accuracy, set quad_degree to 4 or more.
Estimating 34964 MiB required for 3184 by 3184 vertices...
Computing inductance matrix in 1680 chunks (420 MiB memory free),              when approx_far=True using more chunks is faster...
Computing triangle-coupling matrix
Inductance matrix computation took 18.51 seconds.
{&#39;efficiency (nT/mA)&#39;: 1.3180748522426944, &#39;error&#39;: 1.3180748522426944, &#39;homogeneity (%)&#39;: 0.0, &#39;inductance (uH)&#39;: 17671.731783191775, &#39;resistance (ohm)&#39;: 10.530855709785541, &#39;length (m)&#39;: 214.2906685130779, &#39;target radius (cm)&#39;: 17.857142857142854}
The coil has dimensions (1.3961729358002248, 1.398193800411589) m
</pre></div>
</div>
<p>We can now interactively create paths to join the loops in the discretized coils
by making “cuts”. Uncomment below to use it.
coil.make_cuts()</p>
<p>Finally, we can export the files to KiCad</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kicad_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">opm_coils</span><span class="o">.</span><span class="n">__path__</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="s1">&#39;..&#39;</span> <span class="o">/</span> <span class="s1">&#39;kicad&#39;</span> <span class="o">/</span> <span class="s1">&#39;headers&#39;</span>
<a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pcb_dir</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">opm_coils</span><span class="o">.</span><span class="n">__path__</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="s1">&#39;..&#39;</span> <span class="o">/</span> <span class="s1">&#39;development&#39;</span>
<span class="k">if</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">header_type</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_type</span></a><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;vert&#39;</span><span class="p">:</span>
    <span class="n">coil</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">pcb_fname</span><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pcb_dir</span></a> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">output_dir</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_type</span></a><span class="p">]</span><span class="si">}</span><span class="s1">/first/coil_template_first.kicad_pcb&#39;</span><span class="p">,</span>
        <span class="n">kicad_header_fname</span><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kicad_dir</span></a> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;/kicad_header_</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">header_type</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_type</span></a><span class="p">]</span><span class="si">}</span><span class="s1">_first_half.txt&#39;</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">750</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1500</span><span class="p">),</span> <span class="n">origin</span><span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">750</span><span class="p">),</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bounds_wholeloop</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bounds_wholeloop</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_type</span></a><span class="p">])</span>
    <span class="n">coil</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">pcb_fname</span><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pcb_dir</span></a> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">output_dir</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_type</span></a><span class="p">]</span><span class="si">}</span><span class="s1">/second/coil_template_second.kicad_pcb&#39;</span><span class="p">,</span>
        <span class="n">kicad_header_fname</span><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kicad_dir</span></a> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;kicad_header_</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">header_type</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_type</span></a><span class="p">]</span><span class="si">}</span><span class="s1">_second_half.txt&#39;</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1500</span> <span class="p">),</span> <span class="n">origin</span><span class="o">=</span><span class="p">(</span><span class="mi">750</span><span class="p">,</span><span class="mi">750</span><span class="p">),</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bounds_wholeloop</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">bounds_wholeloop</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_type</span></a><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">coil</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">pcb_fname</span><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pcb_dir</span></a> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">output_dir</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_type</span></a><span class="p">]</span><span class="si">}</span><span class="s1">/first/coil_template_first.kicad_pcb&#39;</span><span class="p">,</span>
        <span class="n">kicad_header_fname</span><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kicad_dir</span></a> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;kicad_header_</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">header_type</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_type</span></a><span class="p">]</span><span class="si">}</span><span class="s1">_first_half.txt&#39;</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">750</span><span class="p">),</span> <span class="n">origin</span><span class="o">=</span> <span class="p">(</span><span class="mi">750</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">coil</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">pcb_fname</span><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pcb_dir</span></a> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">output_dir</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_type</span></a><span class="p">]</span><span class="si">}</span><span class="s1">/second/coil_template_second.kicad_pcb&#39;</span><span class="p">,</span>
        <span class="n">kicad_header_fname</span><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">kicad_dir</span></a> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;kicad_header_</span><span class="si">{</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">header_type</span></a><span class="p">[</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">target_type</span></a><span class="p">]</span><span class="si">}</span><span class="s1">_second_half.txt&#39;</span><span class="p">,</span>
        <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">origin</span><span class="o">=</span><span class="p">(</span><span class="mi">750</span><span class="p">,</span> <span class="mi">750</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>export to kicad /Users/mainak/Desktop/github_repos/cmeg_coil_design/opm_coils/../development/By_coil/first/coil_template_first.kicad_pcb:

done

export to kicad /Users/mainak/Desktop/github_repos/cmeg_coil_design/opm_coils/../development/By_coil/second/coil_template_second.kicad_pcb:

done
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (2 minutes 25.408 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-make-contours-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/ed3befe0a8791e5cacaf357bdca34d64/make_contours.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">make_contours.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/5cea2a10ba8dcc18575b966e54f13d76/make_contours.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">make_contours.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023, Mainak Jas.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>